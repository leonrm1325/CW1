<html>
    <head>
        <title>After school club</title>
        <!--script loads vue.js from a server-->
        <script src="https://unpkg.com/vue@2.7.8/dist/vue.js"></script>
        <script src="products.js"></script>
    </head>

    <body>
        <div id="app">
            <header>
                <h1 v-text="sitename"></h1>
                <button> Checkout {{basketItemCount}} </button>
            </header>
            <main>
                <div v-for="product in products">
                    <h2 v-text="product.title"></h2>
                    <figure>
                        <img style="max-width:50px; max-height: 50px;" v-bind:src="product.image">
                    </figure>
                    <p v-text="product.description"></p>
                    <p>Availability: {{product.availability}} spaces</p>
                    <p>Price: Â£ {{product.price}}</p>
                    <button v-on:click='addProduct(product)'>Add</button>
                  </div>
                  
            </main>
        </div>
        <script type="text/javascript">
            //creates vue.js instance
            var webstore = new Vue({
                el: '#app', 
                data: { 
                // sitename key links to the h1 tag
                sitename: 'After School Club booking System',

                products: products,

                basket: [],
                },
                methods: {
                    addProduct: function (product) {
                        if (product.availability > 0) {
                        this.basket.push(product.id);
                        product.availability--;
                        } else {
                        alert("Out of stock");
                        }
                    },
                },
                computed:{
                    basketItemCount:function(){
                        return this.basket.length;
                    }
                }
            });
        </script>
    </body>
</html>